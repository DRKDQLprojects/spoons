(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{2208:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(5893),a=n(1040),u=n(7294),o=n(7820),i=n(6640),c=n(1163),s=n(4148),l=n(2042),f=n(8191),d=n.n(f),v=n(7819),h=n(7454),g=n(1007),p=n(8819),y=n(7478),m=n(6406),b=n(5018),k=function(){var e=(0,u.useState)(""),t=e[0],n=e[1],f=(0,u.useState)(0),k=f[0],j=f[1],x=(0,c.useRouter)(),S=(0,s.sm)(o.Z.database().ref()),O=(0,a.Z)(S,3),_=O[0],E=O[1],P=O[2],w=(0,u.useState)(!1),Z=w[0],C=w[1],N=(0,u.useState)(""),I=N[0],L=N[1],M=(0,u.useState)(""),Q=M[0],T=M[1],D=(0,u.useState)([]),R=D[0],q=D[1],A=(0,u.useState)(""),F=A[0],K=A[1],B=(0,u.useState)(null),H=B[0],J=B[1],$=(0,u.useState)(-1),W=$[0],X=$[1],z=(0,u.useState)(!1),G=z[0],V=z[1];(0,u.useEffect)((function(){if(localStorage.removeItem("saved-player"),localStorage.removeItem("saved-lobby"),!E)if(P)x.push("/404");else if(x.isReady){var e=x.query.code;e?Y(e):x.push("/404")}}),[x,_,P,E]);var Y=function(e){if(_)if(1===_.filter((function(t){return t.key===e})).length){var t=_.filter((function(t){return t.key===e}))[0].val(),n=(0,l.N9)(t.players),r=1===n.filter((function(e){return e.isHost})).length;q(n),T(e),K(r?n.filter((function(e){return e.isHost}))[0].nickname:""),J(t.gameStatus.round>0)}else V(!0),X(2)};d()((function(){if(W>0)X(W-1);else{if(_)1===_.filter((function(e){return e.key===Q})).length||(alert("Lobby not found"),x.push("/404"));X(-1),V(!1)}}),G?1e3:null);return E?(0,r.jsx)(v.Z,{message:"Attempting to find lobby..."}):Z?(0,r.jsx)(v.Z,{message:"Joining lobby..."}):(0,r.jsx)(m.Z,{children:(0,r.jsxs)(y.Z,{container:!0,spacing:0,direction:"column",justifyContent:"center",alignItems:"center",children:[(0,r.jsx)(h.Z,{}),(0,r.jsx)("br",{}),(0,r.jsxs)("h1",{children:[" Joining ","".concat(F,"'s")," Lobby "]}),(0,r.jsx)("br",{}),(0,r.jsx)("h2",{children:" Choose your Avatar "}),(0,r.jsx)("br",{}),(0,r.jsx)(b.Z,{number:k,onNext:function(){return j((k+1)%10)},onPrevious:function(){return j(0===k?9:k-1)}}),(0,r.jsx)("br",{}),(0,r.jsx)("h2",{children:" Enter your Nickname "}),(0,r.jsx)("br",{}),(0,r.jsx)(g.Z,{type:"text",value:t,onPaste:function(e){return e.preventDefault()},onChange:function(e){return t=e.target.value.replace(/[^a-zA-Z\d]/gi,""),L(""),void n(t);var t},maxLength:20,placeholder:"E.g. Marc6789",error:""!==I}),I&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("br",{}),I,(0,r.jsx)("br",{})]}),(0,r.jsx)("br",{}),(0,r.jsx)(p.Z,{onClick:function(){if(C(!0),!t||t.length<3)return L("Your nickname must be at least 3 characters long."),void C(!1);if(0!==R.filter((function(e){return e.nickname.toLocaleLowerCase()===t.toLowerCase()})).length)return L("Sorry this nickname is taken. Please try another nickname."),void C(!1);if(R.length+1>10)return L("The lobby is full. Please try again soon."),void C(!1);if(H)return L("The lobby has already started the game. Please try again soon."),void C(!1);var e=o.Z.database().ref("".concat(Q,"/players")).push().key;o.Z.database().ref("".concat(Q,"/players/").concat(e)).transaction((function(){return{nickname:t,avatar:k,isHost:!1,gameState:i.Qx}})),sessionStorage.setItem("lid",Q),sessionStorage.setItem("pid",e),x.push("/lobby"),C(!1)},primary:!0,disabled:!1,children:" Join "})]})})}},1007:function(e,t,n){"use strict";var r=n(5893),a=n(7840),u=n.n(a);t.Z=function(e){return(0,r.jsx)("input",{className:e.error?u().error:u().textfield,type:e.type,value:e.value,onPaste:e.onPaste,onChange:e.onChange,maxLength:e.maxLength,placeholder:e.placeholder,children:e.children})}},2042:function(e,t,n){"use strict";n.d(t,{jF:function(){return i},N9:function(){return c},Ql:function(){return s},pG:function(){return d},q$:function(){return v},Aj:function(){return h}});var r=n(4942),a=n(6640);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=function(e){var t={};return e.forEach((function(e,n){t[e.id]=o(o({},e),{},{id:null})})),t},c=function(e){return Object.keys(e).map((function(t){return o(o({},e[t]),{},{id:t,gameState:o(o({},e[t].gameState),{},{hand:e[t].gameState.hand||[],pile:e[t].gameState.pile||[]})})}))},s=function(e,t,n){var u=(0,a.$$)(),c=e;t.shuffle&&(c=l(c));var s=n>0?c.filter((function(e){return e.gameState.roundWinner}))[0]:a.CV,d=f(c,n),v=d.filter((function(e){return e.gameState.remaining})),h=i(d);if(t.dealer.on&&v.length>2){var g;g=t.dealer.default||0===n?v[Math.floor(Math.random()*v.length)]:v.filter((function(e){return e.id===s.id}))[0];for(var p=0;p<4*v.length&&p!==4*v.length;p++){var y=p%v.length,m=v[y].id,b=h[m],k=b.gameState,j=u[p];h=o(o({},h),{},(0,r.Z)({},m,o(o({},b),{},{gameState:o(o({},k),{},{hand:k.hand.concat([j])})})))}h[g.id].gameState.dealer=!0;for(var x=4*v.length;x<u.length;x++){var S=h[g.id],O=S.gameState,_=u[x];h=o(o({},h),{},(0,r.Z)({},g.id,o(o({},S),{},{gameState:o(o({},O),{},{pile:O.pile.concat([_])})})))}return h}return u.forEach((function(e,t){var n=t%v.length,a=v[n].id,u=h[a],i=u.gameState,c=!0;4===i.hand.length&&(c=!1),h=o(o({},h),{},(0,r.Z)({},a,o(o({},u),{},{gameState:o(o({},i),{},{hand:c?i.hand.concat([e]):i.hand,pile:c?i.pile:i.pile.concat([e])})})))})),h},l=function(e){for(var t=e,n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*n),a=t[n];t[n]=t[r],t[r]=a}return t},f=function(e,t){var n=e.map((function(e,n){return 0===t?o(o({},e),{},{gameState:o(o({},a.Qx),{},{remaining:!0})}):e.gameState.toBeEliminated?o(o({},e),{},{gameState:o(o({},a.Qx),{},{toBeEliminated:!0,remaining:!1})}):e.gameState.remaining?o(o({},e),{},{gameState:o(o({},a.Qx),{},{remaining:!0})}):e})),u=i(n),s=n.filter((function(e){return e.gameState.remaining}));return s.forEach((function(e,t){u=o(o({},u),{},(0,r.Z)({},e.id,o(o({},e),{},{gameState:o(o({},e.gameState),{},{previousPlayerId:s[(t+s.length-1)%s.length].id,nextPlayerId:s[(t+1)%s.length].id})})))})),c(u)},d=function(e){return"club"===e?"\u2663":"diamond"===e?"\u2666":"heart"===e?"\u2665":"spade"===e?"\u2660":""},v=function(e){return 52-4*e},h=function(e,t){var n=e.length;if("top"===t)switch(n){case 3:return[e[1]];case 4:return[e[1],e[2]];case 5:return[e[1],e[2],e[3]];case 6:return[e[1],e[2],e[3],e[4]];case 7:return[e[1],e[2],e[3],e[4],e[5]];case 8:case 9:return[e[2],e[3],e[4],e[5],e[6]];default:return e}if("left"===t)switch(n){case 3:case 4:case 5:case 6:case 7:return[e[0]];case 8:case 9:return[e[1]];default:return[]}if("right"===t)switch(e.length){case 3:return[e[2]];case 4:return[e[3]];case 5:return[e[4]];case 6:return[e[5]];case 7:return[e[6]];case 8:case 9:return[e[7]];default:return[]}return[]}},9564:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/join",function(){return n(2208)}])},7840:function(e){e.exports={textfield:"TextField_textfield__rjBqy",error:"TextField_error__fiQNW"}},4148:function(e,t,n){"use strict";n.d(t,{sm:function(){return h}});var r=n(7294),a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},u={loading:!0,value:{keys:[],values:[]}},o=function(e,t){switch(t.type){case"add":return t.snapshot?a({},e,{error:void 0,value:c(e.value,t.snapshot,t.previousKey)}):e;case"change":return t.snapshot?a({},e,{error:void 0,value:s(e.value,t.snapshot)}):e;case"error":return a({},e,{error:t.error,loading:!1,value:{keys:void 0,values:void 0}});case"move":return t.snapshot?a({},e,{error:void 0,value:f(e.value,t.snapshot,t.previousKey)}):e;case"remove":return t.snapshot?a({},e,{error:void 0,value:l(e.value,t.snapshot)}):e;case"reset":return u;case"value":return a({},e,{error:void 0,loading:!1,value:i(t.snapshots)});case"empty":return a({},e,{loading:!1,value:{keys:void 0,values:void 0}});default:return e}},i=function(e){if(!e)return{keys:[],values:[]};var t=[],n=[];return e.forEach((function(e){e.key&&(t.push(e.key),n.push(e))})),{keys:t,values:n}},c=function(e,t,n){if(!t.key)return e;var r=e.keys,a=e.values;if(!n)return{keys:r?[t.key].concat(r):[t.key],values:a?[t].concat(a):[t]};var u=r?r.indexOf(n):0;return{keys:r?r.slice(0,u+1).concat([t.key],r.slice(u+1)):[t.key],values:a?a.slice(0,u+1).concat([t],a.slice(u+1)):[t]}},s=function(e,t){if(!t.key)return e;var n=e.keys,r=e.values,u=n?n.indexOf(t.key):0;return a({},e,{values:r?r.slice(0,u).concat([t],r.slice(u+1)):[t]})},l=function(e,t){if(!t.key)return e;var n=e.keys,r=e.values,a=n?n.indexOf(t.key):0;return{keys:n?n.slice(0,a).concat(n.slice(a+1)):[],values:r?r.slice(0,a).concat(r.slice(a+1)):[]}},f=function(e,t,n){var r=l(e,t);return c(r,t,n)},d=function(e,t){var n=!e&&!t,r=!!e&&!!t&&e.isEqual(t);return n||r},v=function(e,t){return function(e,t,n){var a=(0,r.useRef)(e);return(0,r.useEffect)((function(){t(e,a.current)||(a.current=e,n&&n())})),a}(e,d,t)},h=function(e){var t=(0,r.useReducer)(o,u),n=t[0],a=t[1],i=v(e,(function(){return a({type:"reset"})})).current;(0,r.useEffect)((function(){if(i){var e,t=function(e,t){a({type:"add",previousKey:t,snapshot:e})},n=function(e){a({type:"error",error:e})},r=function(e){a({type:"value",snapshots:e})};i.once("value",(function(a){var u=a.val()?Object.keys(a.val()).length:0;if(0===u)e=i.on("child_added",t,n),r([]);else{var o=[];e=i.on("child_added",(function(e,n){if(u>0)return u--,o.push(e),void(0===u&&r(o));t(e,n)}),n)}}),n);var u=i.on("child_changed",(function(e){a({type:"change",snapshot:e})}),n),o=i.on("child_moved",(function(e,t){a({type:"move",previousKey:t,snapshot:e})}),n),c=i.on("child_removed",(function(e){a({type:"remove",snapshot:e})}),n);return function(){i.off("child_added",e),i.off("child_changed",u),i.off("child_moved",o),i.off("child_removed",c)}}a({type:"empty"})}),[a,i]);var c=[n.value.values,n.loading,n.error];return(0,r.useMemo)((function(){return c}),c)}},8191:function(e,t,n){"use strict";var r=n(7294);e.exports=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var u=r.useRef();r.useEffect((function(){u.current=e}),[e]),r.useEffect((function(){if(null!=t){var e=setInterval((function(){u.current&&u.current.apply(u,n)}),t);return function(){return clearInterval(e)}}}),[t])}}},function(e){e.O(0,[774,724,803,626,319,888,179],(function(){return t=9564,e(e.s=t);var t}));var t=e.O();_N_E=t}]);